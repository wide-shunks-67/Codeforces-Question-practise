#include<iostream>#include<vector>#include<cmath>#include<algorithm>#include<climits>#define ll long longusing namespace std;bool check(ll k,ll n, ll max_val,ll min_val, const vector<ll>& arr, const vector<ll>& b){    ll upper_bound= max_val-k;    ll lower_bound= min_val + k;    for(ll i=0;i<n;i++){        if(arr[i]<lower_bound && arr[i]>upper_bound){            if(arr[i]!=b[i]){                return false;            }        }    }    return true;}int main(){    ios_base::sync_with_stdio(false);    cin.tie(NULL);    int t;    cin>>t;    while(t--){        ll n;        cin>>n;        vector<ll> arr(n);        ll max_val = INT_MIN;        ll min_val = INT_MAX;        for(ll i=0;i<n;i++){            cin>>arr[i];            if(arr[i]>max_val) max_val = arr[i];            if(arr[i]<min_val) min_val = arr[i];        }               vector<ll>b=arr;        sort(b.begin(),b.end());         if(b==arr){            cout<<-1<<"\n";            continue;        }         ll low=1;        ll high= max_val - min_val;        ll ans=1;        while(low<=high){            ll mid= low + (high - low)/2;            if(check(mid,n,max_val,min_val,arr,b)){                ans=mid;                low= mid + 1;            }            else{                high= mid - 1;            }        }        cout<<ans<<"\n";    }}